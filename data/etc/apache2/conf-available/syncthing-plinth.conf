##
## On all sites, provide syncthing web interface on a path: /syncthing
##

# Redirect /syncthing to /syncthing/ as the Syncthing server does not
# work without a slash at the end.


TKTAuthPublicKey /etc/apache2/keys/pubkey.pem

<Location /syncthing>
    <IfModule mod_rewrite.c>
        RewriteEngine On
        RewriteCond %{REQUEST_URI} ^/syncthing$
        RewriteRule .* /syncthing/ [R=301,L]
    </IfModule>
</Location>


<Location /syncthing/>

    TKTAuthLoginURL /plinth/accounts/login
    TKTAuthBackArgName next

    ProxyPass http://localhost:8384/
    
    AuthType mod_auth_pubtkt
    AuthName "FreedomBox Single Sign On"

    Require valid-user
</Location>

